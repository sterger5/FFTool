<Window x:Class="FFTool.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="FFTool - 格式转换工具"
        ResizeMode="CanResize"
        MinWidth="800"
        MinHeight="600"
        Background="#ffffff"
        FontFamily="Segoe UI"
        FontSize="14"
        AllowDrop="True"
        DragOver="Window_DragOver"
        Drop="Window_Drop"
        WindowStartupLocation="CenterScreen">

	<Window.Resources>
		<!-- 现代化按钮样式 -->
		<Style x:Key="ModernButton" TargetType="Button">
			<Setter Property="Background" Value="#f8f9fa"/>
			<Setter Property="Foreground" Value="#212529"/>
			<Setter Property="BorderBrush" Value="#dee2e6"/>
			<Setter Property="BorderThickness" Value="1"/>
			<Setter Property="Padding" Value="12,8"/>
			<Setter Property="Margin" Value="0,0,0,8"/>
			<Setter Property="FontWeight" Value="Normal"/>
			<Setter Property="Cursor" Value="Hand"/>
			<Setter Property="Template">
				<Setter.Value>
					<ControlTemplate TargetType="Button">
						<Border x:Name="border" CornerRadius="4" Background="{TemplateBinding Background}"
                                BorderBrush="{TemplateBinding BorderBrush}" BorderThickness="{TemplateBinding BorderThickness}">
							<ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
						</Border>
						<ControlTemplate.Triggers>
							<Trigger Property="IsMouseOver" Value="True">
								<Setter TargetName="border" Property="Background" Value="#e9ecef"/>
								<Setter TargetName="border" Property="BorderBrush" Value="#007bff"/>
							</Trigger>
							<Trigger Property="IsPressed" Value="True">
								<Setter TargetName="border" Property="Background" Value="#007bff"/>
								<Setter Property="Foreground" Value="#ffffff"/>
							</Trigger>
						</ControlTemplate.Triggers>
					</ControlTemplate>
				</Setter.Value>
			</Setter>
		</Style>

		<!-- 主要操作按钮样式 -->
		<Style x:Key="PrimaryButton" TargetType="Button" BasedOn="{StaticResource ModernButton}">
			<Setter Property="Background" Value="#007bff"/>
			<Setter Property="Foreground" Value="#ffffff"/>
			<Setter Property="BorderBrush" Value="#007bff"/>
			<Setter Property="Template">
				<Setter.Value>
					<ControlTemplate TargetType="Button">
						<Border x:Name="border" CornerRadius="4" Background="{TemplateBinding Background}"
                                BorderBrush="{TemplateBinding BorderBrush}" BorderThickness="{TemplateBinding BorderThickness}">
							<ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
						</Border>
						<ControlTemplate.Triggers>
							<Trigger Property="IsMouseOver" Value="True">
								<Setter TargetName="border" Property="Background" Value="#0056b3"/>
								<Setter TargetName="border" Property="BorderBrush" Value="#0056b3"/>
							</Trigger>
							<Trigger Property="IsPressed" Value="True">
								<Setter TargetName="border" Property="Background" Value="#004085"/>
								<Setter TargetName="border" Property="BorderBrush" Value="#004085"/>
							</Trigger>
						</ControlTemplate.Triggers>
					</ControlTemplate>
				</Setter.Value>
			</Setter>
		</Style>

		<!-- 现代化TextBox样式 -->
		<Style x:Key="ModernTextBox" TargetType="TextBox">
			<Setter Property="Background" Value="#ffffff"/>
			<Setter Property="Foreground" Value="#212529"/>
			<Setter Property="BorderBrush" Value="#ced4da"/>
			<Setter Property="BorderThickness" Value="1"/>
			<Setter Property="Padding" Value="8,6"/>
			<Setter Property="Margin" Value="0,0,0,8"/>
			<Setter Property="Template">
				<Setter.Value>
					<ControlTemplate TargetType="TextBox">
						<Border x:Name="border" CornerRadius="4" Background="{TemplateBinding Background}"
                                BorderBrush="{TemplateBinding BorderBrush}" BorderThickness="{TemplateBinding BorderThickness}">
							<ScrollViewer Margin="0" x:Name="PART_ContentHost"/>
						</Border>
						<ControlTemplate.Triggers>
							<Trigger Property="IsMouseOver" Value="True">
								<Setter TargetName="border" Property="BorderBrush" Value="#007bff"/>
							</Trigger>
							<Trigger Property="IsFocused" Value="True">
								<Setter TargetName="border" Property="BorderBrush" Value="#007bff"/>
								<Setter TargetName="border" Property="BorderThickness" Value="2"/>
							</Trigger>
						</ControlTemplate.Triggers>
					</ControlTemplate>
				</Setter.Value>
			</Setter>
		</Style>

		<!-- 现代化ComboBox样式 -->
		<Style x:Key="ModernComboBox" TargetType="ComboBox">
			<Setter Property="Background" Value="#ffffff"/>
			<Setter Property="Foreground" Value="#212529"/>
			<Setter Property="BorderBrush" Value="#ced4da"/>
			<Setter Property="BorderThickness" Value="1"/>
			<Setter Property="Padding" Value="8,6"/>
			<Setter Property="Margin" Value="0,0,0,8"/>
			<Setter Property="Template">
				<Setter.Value>
					<ControlTemplate TargetType="ComboBox">
						<Grid>
							<Border x:Name="border" CornerRadius="4" Background="{TemplateBinding Background}"
                                    BorderBrush="{TemplateBinding BorderBrush}" BorderThickness="{TemplateBinding BorderThickness}">
								<Grid>
									<Grid.ColumnDefinitions>
										<ColumnDefinition Width="*"/>
										<ColumnDefinition Width="20"/>
									</Grid.ColumnDefinitions>
									<ContentPresenter Grid.Column="0" Margin="8,6" VerticalAlignment="Center"/>
									<Path Grid.Column="1" Data="M 0 0 L 4 4 L 8 0 Z" Fill="#6c757d"
                                          HorizontalAlignment="Center" VerticalAlignment="Center"/>
								</Grid>
							</Border>
							<Popup x:Name="PART_Popup" Placement="Bottom" IsOpen="{TemplateBinding IsDropDownOpen}">
								<Border Background="#ffffff" BorderBrush="#ced4da" BorderThickness="1" CornerRadius="4">
									<ScrollViewer>
										<ItemsPresenter/>
									</ScrollViewer>
								</Border>
							</Popup>
						</Grid>
						<ControlTemplate.Triggers>
							<Trigger Property="IsMouseOver" Value="True">
								<Setter TargetName="border" Property="BorderBrush" Value="#007bff"/>
							</Trigger>
							<Trigger Property="IsFocused" Value="True">
								<Setter TargetName="border" Property="BorderBrush" Value="#007bff"/>
								<Setter TargetName="border" Property="BorderThickness" Value="2"/>
							</Trigger>
						</ControlTemplate.Triggers>
					</ControlTemplate>
				</Setter.Value>
			</Setter>
		</Style>

		<!-- 侧边栏列表项样式 -->
		<Style x:Key="SidebarListItem" TargetType="ListBoxItem">
			<Setter Property="Background" Value="Transparent"/>
			<Setter Property="BorderThickness" Value="0"/>
			<Setter Property="Padding" Value="0"/>
			<Setter Property="Margin" Value="0,0,0,2"/>
			<Setter Property="Template">
				<Setter.Value>
					<ControlTemplate TargetType="ListBoxItem">
						<Border x:Name="border" Background="{TemplateBinding Background}" CornerRadius="4" Margin="4,0">
							<ContentPresenter Margin="12,12"/>
						</Border>
						<ControlTemplate.Triggers>
							<Trigger Property="IsSelected" Value="True">
								<Setter TargetName="border" Property="Background" Value="#007bff"/>
							</Trigger>
							<Trigger Property="IsMouseOver" Value="True">
								<Setter TargetName="border" Property="Background" Value="#e9ecef"/>
							</Trigger>
							<MultiTrigger>
								<MultiTrigger.Conditions>
									<Condition Property="IsSelected" Value="True"/>
									<Condition Property="IsMouseOver" Value="True"/>
								</MultiTrigger.Conditions>
								<Setter TargetName="border" Property="Background" Value="#0056b3"/>
							</MultiTrigger>
						</ControlTemplate.Triggers>
					</ControlTemplate>
				</Setter.Value>
			</Setter>
		</Style>

		<!-- 现代化进度条样式 -->
		<Style x:Key="ModernProgressBar" TargetType="ProgressBar">
			<Setter Property="Background" Value="#e9ecef"/>
			<Setter Property="Foreground" Value="#28a745"/>
			<Setter Property="BorderThickness" Value="0"/>
			<Setter Property="Height" Value="8"/>
			<Setter Property="Template">
				<Setter.Value>
					<ControlTemplate TargetType="ProgressBar">
						<Border CornerRadius="4" Background="{TemplateBinding Background}">
							<Border x:Name="PART_Track" CornerRadius="4">
								<Border x:Name="PART_Indicator" CornerRadius="4" Background="{TemplateBinding Foreground}"
                                        HorizontalAlignment="Left"/>
							</Border>
						</Border>
					</ControlTemplate>
				</Setter.Value>
			</Setter>
		</Style>
	</Window.Resources>

	<Grid>
		<Grid.ColumnDefinitions>
			<ColumnDefinition Width="240"/>
			<ColumnDefinition Width="*"/>
		</Grid.ColumnDefinitions>

		<!-- 左侧导航栏 -->
		<Border Grid.Column="0" Background="#f8f9fa" BorderBrush="#dee2e6" BorderThickness="0,0,1,0">
			<Grid>
				<Grid.RowDefinitions>
					<RowDefinition Height="60"/>
					<RowDefinition Height="*"/>
				</Grid.RowDefinitions>

				<!-- 标题区域 -->
				<Border Grid.Row="0" Background="#ffffff" BorderBrush="#dee2e6" BorderThickness="0,0,0,1">
					<Grid>
						<TextBlock Text="FFTool" FontSize="18" FontWeight="SemiBold" Foreground="#212529"
                                   HorizontalAlignment="Center" VerticalAlignment="Center"/>
					</Grid>
				</Border>

				<!-- 媒体类型选择 -->
				<StackPanel Grid.Row="1" Margin="8,16,8,8">
					<TextBlock Text="媒体类型" FontSize="12" FontWeight="Medium" Foreground="#6c757d"
                               Margin="8,0,0,8"/>
					<ListBox x:Name="MediaTypeListBox"
                             SelectionChanged="MediaTypeListBox_SelectionChanged"
                             Background="Transparent"
                             BorderThickness="0"
                             ScrollViewer.HorizontalScrollBarVisibility="Disabled"
                             ItemContainerStyle="{StaticResource SidebarListItem}">
						<ListBox.ItemTemplate>
							<DataTemplate>
								<StackPanel Orientation="Horizontal">
									<TextBlock Text="🎬" FontSize="16" Margin="0,0,8,0" x:Name="Icon"/>
									<TextBlock Text="{Binding Name}" FontSize="14" Foreground="#212529" VerticalAlignment="Center" x:Name="NameText"/>
								</StackPanel>
								<DataTemplate.Triggers>
									<DataTrigger Binding="{Binding Name}" Value="音频">
										<Setter TargetName="Icon" Property="Text" Value="🎵"/>
									</DataTrigger>
									<DataTrigger Binding="{Binding Name}" Value="图片">
										<Setter TargetName="Icon" Property="Text" Value="🖼️"/>
									</DataTrigger>
									<DataTrigger Binding="{Binding RelativeSource={RelativeSource AncestorType=ListBoxItem}, Path=IsSelected}" Value="True">
										<Setter TargetName="NameText" Property="Foreground" Value="#ffffff"/>
									</DataTrigger>
								</DataTemplate.Triggers>
							</DataTemplate>
						</ListBox.ItemTemplate>
					</ListBox>
				</StackPanel>
			</Grid>
		</Border>

		<!-- 右侧主要内容区域 -->
		<Grid Grid.Column="1" Background="#ffffff">
			<Grid.RowDefinitions>
				<RowDefinition Height="60"/>
				<RowDefinition Height="*"/>
			</Grid.RowDefinitions>

			<!-- 标题栏 -->
			<Border Grid.Row="0" Background="#f8f9fa" BorderBrush="#dee2e6" BorderThickness="0,0,0,1">
				<Grid>
					<TextBlock Text="格式转换工具" FontSize="16" FontWeight="Medium" Foreground="#212529"
                               HorizontalAlignment="Left" VerticalAlignment="Center" Margin="24,0"/>
				</Grid>
			</Border>

			<!-- 主要操作区域 -->
			<ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto" HorizontalScrollBarVisibility="Disabled">
				<StackPanel Margin="32,24,32,32" MaxWidth="600" HorizontalAlignment="Left">

					<!-- 文件选择区域 -->
					<Border Background="#ffffff" BorderBrush="#dee2e6" BorderThickness="1" CornerRadius="8" Padding="24" Margin="0,0,0,16">
						<StackPanel>
							<TextBlock Text="📁 选择文件" FontSize="16" FontWeight="Medium" Foreground="#212529" Margin="0,0,0,16"/>

							<Grid>
								<Grid.ColumnDefinitions>
									<ColumnDefinition Width="*"/>
									<ColumnDefinition Width="Auto"/>
								</Grid.ColumnDefinitions>

								<TextBox x:Name="FilePathBox" Grid.Column="0"
                                         Style="{StaticResource ModernTextBox}"
                                         IsReadOnly="True"
                                         Margin="0,0,12,0"
                                         Text="拖拽文件到此处或点击选择文件"/>

								<Button Grid.Column="1" Content="浏览文件"
                                        Style="{StaticResource ModernButton}"
                                        Click="Browse_Click"
                                        Margin="0,0,0,8"
                                        Width="100"/>
							</Grid>
						</StackPanel>
					</Border>

					<!-- 输出设置区域 -->
					<Border Background="#ffffff" BorderBrush="#dee2e6" BorderThickness="1" CornerRadius="8" Padding="24" Margin="0,0,0,16">
						<StackPanel>
							<TextBlock Text="⚙️ 输出设置" FontSize="16" FontWeight="Medium" Foreground="#212529" Margin="0,0,0,16"/>

							<Grid>
								<Grid.RowDefinitions>
									<RowDefinition Height="Auto"/>
									<RowDefinition Height="Auto"/>
								</Grid.RowDefinitions>
								<Grid.ColumnDefinitions>
									<ColumnDefinition Width="*"/>
									<ColumnDefinition Width="Auto"/>
								</Grid.ColumnDefinitions>

								<TextBox x:Name="OutputPathBox" Grid.Row="0" Grid.Column="0"
                                         Style="{StaticResource ModernTextBox}"
                                         IsReadOnly="True"
                                         Margin="0,0,12,0"
                                         Text="默认保存到源文件目录"/>

								<Button Grid.Row="0" Grid.Column="1" Content="输出目录"
                                        Style="{StaticResource ModernButton}"
                                        Click="BrowseOutputFolder_Click"
                                        Margin="0,0,0,8"
                                        Width="100"/>

								<StackPanel Grid.Row="1" Grid.Column="0" Orientation="Horizontal" Margin="0,8,0,0">
									<TextBlock Text="目标格式：" VerticalAlignment="Center" Foreground="#6c757d" Margin="0,0,12,0"/>
									<ComboBox x:Name="FormatBox" Style="{StaticResource ModernComboBox}" Width="120" Margin="0,0,0,8"/>
								</StackPanel>
							</Grid>
						</StackPanel>
					</Border>

					<!-- 操作按钮区域 -->
					<Border Background="#ffffff" BorderBrush="#dee2e6" BorderThickness="1" CornerRadius="8" Padding="24" Margin="0,0,0,16">
						<StackPanel>
							<TextBlock Text="🚀 操作" FontSize="16" FontWeight="Medium" Foreground="#212529" Margin="0,0,0,16"/>

							<StackPanel Orientation="Horizontal">
								<Button Content="开始转换"
                                        Style="{StaticResource PrimaryButton}"
                                        Click="Convert_Click"
                                        Width="120"
                                        Margin="0,0,12,8"/>

								<Button Content="中止转换"
                                        Style="{StaticResource ModernButton}"
                                        Click="Cancel_Click"
                                        Width="120"
                                        Margin="0,0,0,8"/>
							</StackPanel>
						</StackPanel>
					</Border>

					<!-- 状态信息区域 -->
					<Border Background="#ffffff" BorderBrush="#dee2e6" BorderThickness="1" CornerRadius="8" Padding="24">
						<StackPanel>
							<TextBlock Text="📊 状态" FontSize="16" FontWeight="Medium" Foreground="#212529" Margin="0,0,0,16"/>

							<TextBlock x:Name="StatusText" Text="准备就绪" Foreground="#17a2b8" FontSize="14" Margin="0,0,0,12"/>

							<ProgressBar x:Name="ProgressBar" Style="{StaticResource ModernProgressBar}"
                                         Minimum="0" Maximum="100" Value="0"/>
						</StackPanel>
					</Border>
				</StackPanel>
			</ScrollViewer>
		</Grid>
	</Grid>
</Window>